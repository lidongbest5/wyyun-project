!function(){var e=$(window).width(),n=$(".page1"),t=$(".page2"),o=$(".page3"),a=$(".page4"),i=$(".page5"),d=$(".voice"),s,r,l,c=[],u=[],p=null,m,h,g,w=!1,f,v,b=null,S="path://M1705.06,1318.313v-89.254l-319.9-221.799l0.073-208.063c0.521-84.662-26.629-121.796-63.961-121.491c-37.332-0.305-64.482,36.829-63.961,121.491l0.073,208.063l-319.9,221.799v89.254l330.343-157.288l12.238,241.308l-134.449,92.931l0.531,42.034l175.125-42.917l175.125,42.917l0.531-42.034l-134.449-92.931l12.238-241.308L1705.06,1318.313z",y={"海门":[121.15,31.89],"鄂尔多斯":[109.781327,39.608266],"招远":[120.38,37.35],"舟山":[122.207216,29.985295],"齐齐哈尔":[123.97,47.33],"盐城":[120.13,33.38],"赤峰":[118.87,42.28],"青岛":[120.33,36.07],"乳山":[121.52,36.89],"金昌":[102.188043,38.520089],"泉州":[118.58,24.93],"莱西":[120.53,36.86],"日照":[119.46,35.42],"胶南":[119.97,35.88],"南通":[121.05,32.08],"拉萨":[91.11,29.97],"云浮":[112.02,22.93],"梅州":[116.1,24.55],"文登":[122.05,37.2],"上海":[121.48,31.22],"攀枝花":[101.718637,26.582347],"威海":[122.1,37.5],"承德":[117.93,40.97],"厦门":[118.1,24.46],"汕尾":[115.375279,22.786211],"潮州":[116.63,23.68],"丹东":[124.37,40.13],"太仓":[121.1,31.45],"曲靖":[103.79,25.51],"烟台":[121.39,37.52],"福州":[119.3,26.08],"瓦房店":[121.979603,39.627114],"即墨":[120.45,36.38],"抚顺":[123.97,41.97],"玉溪":[102.52,24.35],"张家口":[114.87,40.82],"阳泉":[113.57,37.85],"莱州":[119.942327,37.177017],"湖州":[120.1,30.86],"汕头":[116.69,23.39],"昆山":[120.95,31.39],"宁波":[121.56,29.86],"湛江":[110.359377,21.270708],"揭阳":[116.35,23.55],"荣成":[122.41,37.16],"连云港":[119.16,34.59],"葫芦岛":[120.836932,40.711052],"常熟":[120.74,31.64],"东莞":[113.75,23.04],"河源":[114.68,23.73],"淮安":[119.15,33.5],"泰州":[119.9,32.49],"南宁":[108.33,22.84],"营口":[122.18,40.65],"惠州":[114.4,23.09],"江阴":[120.26,31.91],"蓬莱":[120.75,37.8],"韶关":[113.62,24.84],"嘉峪关":[98.289152,39.77313],"广州":[113.23,23.16],"延安":[109.47,36.6],"太原":[112.53,37.87],"清远":[113.01,23.7],"中山":[113.38,22.52],"昆明":[102.73,25.04],"寿光":[118.73,36.86],"盘锦":[122.070714,41.119997],"长治":[113.08,36.18],"深圳":[114.07,22.62],"珠海":[113.52,22.3],"宿迁":[118.3,33.96],"咸阳":[108.72,34.36],"铜川":[109.11,35.09],"平度":[119.97,36.77],"佛山":[113.11,23.05],"海口":[110.35,20.02],"江门":[113.06,22.61],"章丘":[117.53,36.72],"肇庆":[112.44,23.05],"大连":[121.62,38.92],"临汾":[111.5,36.08],"吴江":[120.63,31.16],"石嘴山":[106.39,39.04],"沈阳":[123.38,41.8],"苏州":[120.62,31.32],"茂名":[110.88,21.68],"嘉兴":[120.76,30.77],"长春":[125.35,43.88],"胶州":[120.03336,36.264622],"银川":[106.27,38.47],"张家港":[120.555821,31.875428],"三门峡":[111.19,34.76],"锦州":[121.15,41.13],"南昌":[115.89,28.68],"柳州":[109.4,24.33],"三亚":[109.511909,18.252847],"自贡":[104.778442,29.33903],"吉林":[126.57,43.87],"阳江":[111.95,21.85],"泸州":[105.39,28.91],"西宁":[101.74,36.56],"宜宾":[104.56,29.77],"呼和浩特":[111.65,40.82],"成都":[104.06,30.67],"大同":[113.3,40.12],"镇江":[119.44,32.2],"桂林":[110.28,25.29],"张家界":[110.479191,29.117096],"宜兴":[119.82,31.36],"北海":[109.12,21.49],"西安":[108.95,34.27],"金坛":[119.56,31.74],"东营":[118.49,37.46],"牡丹江":[129.58,44.6],"遵义":[106.9,27.7],"绍兴":[120.58,30.01],"扬州":[119.42,32.39],"常州":[119.95,31.79],"潍坊":[119.1,36.62],"重庆":[106.54,29.59],"台州":[121.420757,28.656386],"南京":[118.78,32.04],"滨州":[118.03,37.36],"贵阳":[106.71,26.57],"无锡":[120.29,31.59],"本溪":[123.73,41.3],"克拉玛依":[84.77,45.59],"渭南":[109.5,34.52],"马鞍山":[118.48,31.56],"宝鸡":[107.15,34.38],"焦作":[113.21,35.24],"句容":[119.16,31.95],"北京":[116.46,39.92],"徐州":[117.2,34.26],"衡水":[115.72,37.72],"包头":[110,40.58],"绵阳":[104.73,31.48],"乌鲁木齐":[87.68,43.77],"枣庄":[117.57,34.86],"杭州":[120.19,30.26],"淄博":[118.05,36.78],"鞍山":[122.85,41.12],"溧阳":[119.48,31.43],"库尔勒":[86.06,41.68],"安阳":[114.35,36.1],"开封":[114.35,34.79],"济南":[117,36.65],"德阳":[104.37,31.13],"温州":[120.65,28.01],"九江":[115.97,29.71],"邯郸":[114.47,36.6],"临安":[119.72,30.23],"兰州":[103.73,36.03],"沧州":[116.83,38.33],"临沂":[118.35,35.05],"南充":[106.110698,30.837793],"天津":[117.2,39.13],"富阳":[119.95,30.07],"泰安":[117.13,36.18],"诸暨":[120.23,29.71],"郑州":[113.65,34.76],"哈尔滨":[126.63,45.75],"聊城":[115.97,36.45],"芜湖":[118.38,31.33],"唐山":[118.02,39.63],"平顶山":[113.29,33.75],"邢台":[114.48,37.05],"德州":[116.29,37.45],"济宁":[116.59,35.38],"荆州":[112.239741,30.335165],"宜昌":[111.3,30.7],"义乌":[120.06,29.32],"丽水":[119.92,28.45],"洛阳":[112.44,34.7],"秦皇岛":[119.57,39.95],"株洲":[113.16,27.83],"石家庄":[114.48,38.03],"莱芜":[117.67,36.19],"常德":[111.69,29.05],"保定":[115.48,38.85],"湘潭":[112.91,27.87],"金华":[119.64,29.12],"岳阳":[113.09,29.37],"长沙":[113,28.21],"衢州":[118.88,28.97],"廊坊":[116.7,39.53],"菏泽":[115.480656,35.23375],"合肥":[117.27,31.86],"武汉":[114.31,30.52],"大庆":[125.03,46.58]},z=function(){var t=C("shareid");t&&($(".share-img").attr("src","/static/guozu/upload/"+t+".png"),$(".page8").show()),window.setTimeout(function(){r=window.setInterval(function(){if(window.uData){window.clearInterval(r),n.addClass("animated rotateOut").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){n.hide(),$(".i1-t").addClass("animated bounceInRight visible"),$(".slide1 .p2").addClass("animated rotateIn visible"),s=document.getElementById("music"),s.play()}),A();var e,t=C("fromsource");e=t?"http://ex.wyyun.com/project/lesports_guozu/?fromsource="+t+"&shareid="+window.uData.openid:"http://ex.wyyun.com/project/lesports_guozu/?shareid="+window.uData.openid,setShare("点亮中国 助威国足",e,"http://ex.wyyun.com/static/guozu/images/p4.png"),$(".preview").attr("src",window.uData.headimgurl),p=window.uData.headimgurl,$.ajax({url:"/project/lesports_guozu/guozuSaveImage/",type:"POST",data:{img:window.uData.headimgurl,openid:window.uData.openid},success:function(){}})}},100)},1500);var o=new Swiper(".swiper-loading",{direction:"vertical"});o.on("transitionStart",function(e){}),o.on("onSlideChangeEnd",function(e){0===e.activeIndex?($(".i1-t").addClass("animated bounceInRight visible"),$(".slide1 .p2").addClass("animated rotateIn visible"),$(".up").show()):1===e.activeIndex?($(".i2-t").addClass("animated bounceInDown visible"),$(".slide2 .p10").addClass("animated rotateIn visible"),$(".up").show()):2===e.activeIndex&&($(".i3-t").addClass("animated bounceInRight visible"),$(".p3").addClass("animated bounceInLeft visible"),$(".p4").addClass("animated zoomIn visible"),$(".up").hide())});var a=new Swiper(".swiper-tip",{pagination:".swiper-pagination",paginationClickable:!0,direction:"horizontal",nextButton:".swiper-button-next",prevButton:".swiper-button-prev",spaceBetween:30});$(".map").height(.75*e),bindEventListener()},C=function(e,n){n||(n=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),o=t.exec(n);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null},x=function(e,n){var t=e.split("?");if(t.length>=2){for(var o=encodeURIComponent(n)+"=",a=t[1].split(/[&;]/g),i=a.length;i-- >0;)-1!==a[i].lastIndexOf(o,0)&&a.splice(i,1);return e=t[0]+(a.length>0?"?"+a.join("&"):"")}return e},E=function(e){for(var n=[],t=0;t<e.length;t++){var o=y[e[t].name];o&&n.push({name:e[t].name,value:o.concat(e[t].value)})}return n},I=function(e){for(var n=[],t=0;t<e.length;t++){var o=y[e[t].name];o&&n.push({name:e[t].name,value:o.concat(e[t].value),data:e[t]})}return n},A=function(){var e;e=-1!==window.location.href.indexOf("shareid=")?window.location.href.split("shareid=")[1].split("&")[0]:window.uData.openid,$.ajax({url:"/project/lesports_guozu/getData/",type:"POST",data:{openid:e},success:function(e){l=echarts.init(document.getElementById("map")),e=JSON.parse(e),m=JSON.parse(e.city),h=JSON.parse(e.record),g=JSON.parse(e.data),v=e.type,setMap(),$(".page3-title span").text(e.total+225e3);for(var n="",t=0;10>t;t++)n+='<li class="clearfix"><div><span>'+(t+1)+"</span>"+m[t].fields.name+"</div>"+m[t].fields.count+"次</li>";$(".page3-list ul").html(n)}})},O=function(){t.addClass("animated bounceOutDown").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){t.hide(),window.addEventListener("devicemotion",D,!1)})},D=function(n){"/static/guozu/images/ball.gif"!==$(".ball").attr("src")&&$(".ball").attr("src","/static/guozu/images/ball.gif");var t=n.accelerationIncludingGravity.x,o=.45*e;Math.abs(t/6)>1?onLight():$(".ball").css("transform","translateX("+o*t/6+"px)")};setPopup=function(e){var n=g[e].fields.city.length?g[e].fields.city:"北京";$(".map-avatar").attr("src",getImage(g[e].fields.image)),$(".map-title").text("来自"+n+"的"+g[e].fields.name+":"),$(".map-word").text(g[e].fields.word);var t=new Date(g[e].fields.date);$(".map-time").text(t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate())},setMap=function(){if($(".map").empty(),l=echarts.init(document.getElementById("map")),m.forEach(function(e){c.push({name:e.fields.name,value:e.fields.count})}),g.length){1===v&&(g[0]=h[0]),g.forEach(function(e){u.push({name:e.fields.city,value:300})}),setPopup(0);var e=1;b&&window.clearInterval(b),b=window.setInterval(function(){$(".map-modal").addClass("animated bounceOut").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(".map-modal").removeClass("animated bounceOut"),setPopup(e),e++,e>g.length-1&&(e=0),$(".map-modal").addClass("animated bounceIn").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(".map-modal").removeClass("animated bounceIn")})})},3e3)}var n={tooltip:{trigger:"item"},legend:{orient:"vertical",y:"bottom",x:"right",textStyle:{color:"#fff"}},geo:{map:"china",label:{emphasis:{show:!1}},roam:!1,zoom:1.2,itemStyle:{normal:{areaColor:"#d32c25",borderColor:"#111",shadowColor:"#d32c25",shadowBlur:110},emphasis:{areaColor:"#d32c25"}}},series:[{type:"scatter",coordinateSystem:"geo",data:E(c),symbolSize:function(e){return e[2]>3e3?10:e[2]<120?e[2]/30:e[2]/500},label:{normal:{formatter:"{b}",position:"right",show:!1},emphasis:{show:!0}},itemStyle:{normal:{color:"#ddb926"}}},{name:"北京到莫斯科",type:"lines",zlevel:1,effect:{show:!0,period:5,trailLength:.7,color:"#fff",symbolSize:5},lineStyle:{normal:{color:"red",width:0,curveness:.2}},data:[{coords:[[116.4551,40.2539],[81.4124,55.0901]],lineStyle:{normal:{}}}]},{name:"北京到莫斯科",type:"lines",zlevel:2,effect:{show:!0,period:5,trailLength:0,symbol:S,symbolSize:25},lineStyle:{normal:{color:"white",width:0,opacity:.4,curveness:.2}},data:[{coords:[[116.4551,40.2539],[81.4124,55.0901]],lineStyle:{normal:{}}}]},{type:"effectScatter",coordinateSystem:"geo",data:E(u),symbolSize:15,showEffectOn:"render",rippleEffect:{brushType:"stroke"},hoverAnimation:!0,label:{normal:{formatter:"{b}",position:"right",show:!0}},itemStyle:{normal:{color:"#f4e925",borderWidth:0},emphasis:{color:"#f4e925",borderWidth:0}},zlevel:1}]};l.setOption(n)},onLight=function(){a.css("z-index",99),a.addClass("animated fadeInUp").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){a.removeClass("animated fadeInUp"),window.removeEventListener("devicemotion",D,!1),$(".ball").attr("src","/static/guozu/images/ball1.gif")})},onSubmit=function(){if(p){var e=window.uData.nickname.replace(/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g,"");$(".p8").hide(),$(".publish-tip").show(),$.ajax({url:"/project/lesports_guozu/submit/",type:"POST",data:{img:p,word:$(".swiper-tip .swiper-slide-active").attr("data"),index:$(".swiper-tip .swiper-slide-active").attr("index"),name:e,image_type:-1!==p.indexOf("http:")?1:2,openid:window.uData.openid},success:function(e){e=JSON.parse(e),h=JSON.parse(e.record),setMap(),onClose1(),$(".page5-img .logo").attr("src","/static/guozu/upload/"+e.img);var n,t=C("fromsource");n=t?"http://ex.wyyun.com/project/lesports_guozu/?fromsource="+t+"&shareid="+window.uData.openid:"http://ex.wyyun.com/project/lesports_guozu/?shareid="+window.uData.openid,$(".phone").show();var o=h[0].fields.city.length?h[0].fields.city:"北京";setShare("来不及解释了，今天我站国足！我在"+o+"，排名第"+(parseInt(h[0].pk)+224900)+"位为国足助威！接下来该你了！",n,getImage(h[0].fields.image)),$(".page3-title span").text(parseInt($(".page3-title span").text())+1),i.css("z-index",99),i.show(),$(".p8").show(),$(".publish-tip").hide(),$(".p8").one("touchend",onSubmit)},error:function(e){$(".p8").one("touchend",onSubmit)}})}else alert("请先上传照片！"),$(".p8").one("touchend",onSubmit);return!1},getImage=function(e){return-1!==e.indexOf("http:")?e:"/static/guozu/upload/m_"+e},onUpload=function(){var e=new FormData($("#upload_form")[0]);e.append("file",$("input[type=file]")[0].files[0]),e.append("openid",window.uData.openid),$("#upload_form").prepend('<p class="upload-tip">上传中...</p>'),$.ajax({url:"/project/lesports_guozu/upload/",type:"POST",data:e,contentType:!1,processData:!1,success:function(e){p=e,$(".preview").attr("src",getImage(e)),$(".upload-tip, .upload-btn").hide()}})},onVoice=function(){d.hasClass("open")?(d.removeClass("open").attr("src","/static/guozu/images/voice-no.png"),s.pause()):(d.addClass("open").attr("src","/static/guozu/images/voice.png"),s.play())},onClose1=function(){a.css("z-index",2),a.addClass("animated zoomOut").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){a.removeClass("animated zoomOut")}),window.addEventListener("devicemotion",D,!1)},onClose2=function(){i.css("z-index",1),i.addClass("animated zoomOut").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){i.removeClass("animated zoomOut")})},onGetCode=function(){var e=$(".phone-number").val();e.length?/^1[3|4|5|7|8]\d{9}$/.test(e)?($(".getcode").html("发送中..."),$.ajax({url:"/project/lesports_guozu/getCode/",type:"POST",data:{phone:e},success:function(n){$(".phone2 span").text(e),f=n;var t=60,o=window.setInterval(function(){$(".getcode").html(t+"秒后重发"),t--,0===t&&(window.clearInterval(o),$(".getcode").html("获取验证码"),$(".getcode").one("touchend",onGetCode))},1e3)}})):(alert("请输入正确手机号"),$(".getcode").one("touchend",onGetCode)):(alert("请输入手机号"),$(".getcode").one("touchend",onGetCode))},onAward=function(){var e=$(".code").val();e.length?e==f?($(".phone1").hide(),$(".phone2").show(),$.ajax({url:"/project/lesports_guozu/getMsg/",type:"POST",data:{phone:$(".phone-number").val()},success:function(e){console.log(e)}})):alert("验证码错误"):alert("请输入验证码")},setShare=function(e,n,t){wx.ready(function(){wx.onMenuShareTimeline({title:e,link:n,imgUrl:t,success:function(){onShowSuccess()},cancel:function(){}}),wx.onMenuShareAppMessage({title:e,desc:e,link:n,imgUrl:t,type:"",dataUrl:"",success:function(){onShowSuccess()},cancel:function(){}})})},onShowSuccess=function(){$(".page7").hide(),$(".page6").css("z-index",1e3),i.addClass("animated zoomOut").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){i.removeClass("animated zoomOut")})},onShowShare=function(){$(".page7").show()},onHideShare=function(){$(".page7").hide()},onHideTips=function(){$(".tipss").hide()},onHome=function(){var e=x(window.location.href,"code");e=x(e,"state"),window.location.href=e},onShareStart=function(){$(".page2, .page8").hide(),window.addEventListener("devicemotion",D,!1)},bindEventListener=function(){d.on("touchend",onVoice),$(".p4").on("touchend",O),$(".p6").on("touchend",onLight),$(".p8").one("touchend",onSubmit),$("#upload_file").on("change",onUpload),$(".page4 .close").on("touchend",onClose1),$(".page5 .close").on("touchend",onClose2),$(".phone-btn").on("touchend",onAward),$(".getcode").one("touchend",onGetCode),$(".p11").on("touchend",onShowShare),$(".page7").on("touchend",onHideShare),$(".tipss").on("touchend",onHideTips),$(".p12").on("touchend",onHome),$(".p14").on("touchend",onShareStart)},$(z)}();